<app-header></app-header>
<br/>
<form #f="ngForm" (ngSubmit)="onSubmit()">
  <div class="location-details">
      <h2>Location Details</h2>
      <div class="details">
        <img src="{{ property.img }}" alt="Property Photo" class="property-photo">
        <p><strong>City:</strong> {{ property.city }}</p>
        <p><strong>Street:</strong> {{ property.street }}</p>
        <p><strong>Zip Code:</strong> {{ property.zipCode }}</p>
        <p><strong>Number of Sleeps:</strong> {{ property.numSleeps }}</p>
        <p><strong>Number of Bedrooms:</strong> {{ property.numBedrooms }}</p>
        <p><strong>Distance to City Center:</strong> {{ property.distance }} km</p>
        <p><strong>Price per Night:</strong> {{ property.price }}€ </p>
        <p *ngIf="property.review"><strong>Review Score:</strong> {{ property.review }}</p>
        <div *ngIf="!filter.startDate || !filter.endDate">
          <div class="form-group">
            <label for="start-date">Début :</label>
            <input type="date"  placeholder="Début" class="form-control" id="start-date" name="start-date" [(ngModel)]="filter_model.startDate">
          </div>
          <div class="form-group">
            <label for="end-date">Fin :</label>
            <input type="date" placeholder="Fin" class="form-control" id="end-date" name="end-date" [(ngModel)]="filter_model.endDate" >
          </div>
          <div class="form-group">
            <label for="numSleeps">Nombre de personnes :</label>
            <div>
              <button type="button" (click)="decrementValue()" [disabled]="filter_model.minBeds == 1 ">-</button>
              <input type="text" disabled="true" class="form-control" id="numSleeps" name="numSleeps" min="1" [max]="property.numSleeps" [(ngModel)]="filter_model.minBeds">
              <button type="button" (click)="incrementValue()" [disabled]="filter_model.minBeds == property.numSleeps">+</button>
            </div>
          </div> 
        </div>
      </div>
      <div *ngIf="!propertyAvailable" class="error">
        <p>Le bien n'est malheureusement pas disponible.</p>
      </div>
      <input type="submit" class="confirm-button" value="Confirmer la location">
  </div>
</form>
<div class="map-title" id="map">
  <h3>Où se situe le logement ?</h3>
  <h2>Adresse: {{ property.street }}, {{ property.zipCode }} {{ property.city }}</h2>
  <h2>Vous trouverez ci-dessous la carte de localisation du logement. <a href="location#map" style="color: black;"><i class="fas fa-arrow-down"></i> </a> </h2>
</div>
<div class="map-responsive">
  <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d5775.347315428806!2d3.8655808!3d43.6341508!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x12b6af26d6c6db7b%3A0x6f657489e9c61009!2s1424%20Rte%20de%20Mende%2C%2034090%20Montpellier!5e0!3m2!1sfr!2sfr!4v1714035152648!5m2!1sfr!2sfr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
</div>
<br/>
<app-footer></app-footer>


<div class="overlay" *ngIf="showOverlay">
  <div class="payment-overlay">
    <div class="payment-modal">
      <h1>Facturation</h1>
      <div class="payment-details">
        <h2>Reservation Détails</h2>
        <div class="price-item">
          <span>{{ property.price }} € x {{ calculateNumberOfNights() }} nights</span>
          <span>Total: {{ calculateTotalPrice() }} €</span>
        </div>      
      </div>
      <form #f="ngForm" (ngSubmit)="onSubmitReservation()">
        <div class="payment-form">
          <h2>Paiement Informations</h2>
          <div class="form-group">
            <label for="card-number">Card number:</label>
            <input type="text" class="form-control" id="card-number" name="card-number" [(ngModel)]="payment.cardNumber" required>
          </div>
          <div class="form-group">
            <label for="expiration-date">Expiration date:</label>
            <input type="text" class="form-control" id="expiration-date" name="expiration-date" [(ngModel)]="payment.expirationDate" required>
          </div>
          <div class="form-group">
            <label for="cvv">CVV:</label>
            <input type="text" class="form-control" id="cvv" name="cvv" [(ngModel)]="payment.cvv" required>
          </div>
          <div class="button-group">
            <button class="cancel-button" (click)="closeOverlay()">Cancel</button>
            <input type="submit" class="confirm-button" value="Confirm">
          </div>
        </div>
      </form>
    </div>
  </div>
</div> 
